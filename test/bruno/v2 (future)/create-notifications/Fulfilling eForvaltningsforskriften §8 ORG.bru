meta {
  name: Fulfilling eForvaltningsforskriften ยง8 ORG
  type: http
  seq: 1
}

post {
  url: {{host}}/notifications/api/v1/future/orders
  body: json
  auth: inherit
}

body:json {
  {
    "idempotencyId": "{{random_idempotency_id}}",
    "sendersReference": "{{random_idempotency_id}}",
     "recipient": {
      "recipientOrganization": {
        "orgNumber": "{{process.env.TESTDATA_TENOR_SET_1_ORG}}",
        "channelSchema": "SmsPreferred",
        "resourceId": "urn:altinn:resource:app_ttd_storage-end-to-end",
        "smsSettings": {
          "sendingTimePolicy": "Daytime",
          "body": "(TEST) Dear $recipientName$, please check your email for an important update regarding your account $recipientNumber$. - Altinn Team"
        },
        "emailSettings": {
          "contentType": "Plain",
          "sendingTimePolicy": "Anytime",
          "subject": "(TEST) Important Update Regarding Your Account",
          "body": "(TEST) Dear $recipientName$,\n\nWe wanted to inform you about an important update to your account $recipientNumber$. Please log in to your dashboard to review the changes.\n\nBest regards,\nAltinn Team"
        }
      }
    },
    "reminders": [
      {
        "conditionEndpoint": "{{process.env.TESTDATA_URL_CONDITION_TRUE}}",
        "sendersReference": "{{random_idempotency_id}}",
        "requestedSendTime": "2025-08-06T11:00:00Z",
        "recipient": {
          "recipientOrganization": {
            "orgNumber": "{{process.env.TESTDATA_TENOR_SET_1_ORG}}",
            "channelSchema": "SmsPreferred",
            "emailSettings": {
              "subject": "(TEST) Important Update Regarding Your Account",
              "body": "(TEST) Dear $recipientName$,\n\nWe wanted to inform you about an important update to your account $recipientNumber$. Please log in to your dashboard to review the changes.\n\nBest regards,\nAltinn Team",
              "contentType": "Plain",
              "sendingTimePolicy": "Anytime"
            },
            "smsSettings": {
              "sendingTimePolicy": "Daytime",
              "body": "(TEST) Dear $recipientName$, please check your email for an important update regarding your account $recipientNumber$. - Altinn Team"
            }
          }
        }
      }
    ]
  }
}
